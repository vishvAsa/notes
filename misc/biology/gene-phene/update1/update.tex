\documentclass{article}
% \usepackage[left=3cm,top=1.5cm,right=3cm,bottom=3cm]{geometry}
\usepackage{caption, subfigure}
\input{/u/vvasuki/vishvas/work/packages}
\input{/u/vvasuki/vishvas/work/macros}

%opening
\title{Update 1: Evaluation of Gene Phene Link Predictors}
\author{Nagarajan Natarajan, vishvAs vAsuki}

\begin{document}
\maketitle
\tableofcontents

\section{Three Evaluation methods}
\label{sec:Three Evaluation methods}
\subsection{Evaluation method A}
Divide the set of all genes into 10 roughly equal subsets - or equivalently, divide the human gene phene matrix P into 10 submatrices. Then, learn scores for each submatrix using the other 9. Then, judge the goodness of scores generated by a predictor by seeing how highly this score matrix ranks all the 1's in P. To do this, for each phene, use AUC to evaluate how highly all observed gene-phene links are ranked.

This is the evaluation technique used in \cite{McGaryOrthologousPhenotypes}. Our meetings with John in May indicate that this understanding of their evaluation strategy is indeed correct. This is also confirmed by comparing the figures in \cite{McGaryOrthologousPhenotypes} with the  curve labelled \textit{phenologs predictor (Marcotte lab)} in Figure \ref{fig:probabilisticFixedVsProbabilistic_QualitativeTest}. In contrast, the way we have evaluated predictors so far is described in the Sections below.

\subsection{Evaluation method B}
\label{sec:Evaluation method B}
For each phene, keep aside a set of observed gene-phene links as a test set. Then, use the remainder to score various potential gene-phene links. (Note that, while this evaluation framework allows us to train predictors separately for each phene, we have not done so in the ineterests of speed.) Finally, judge the goodness of this score matrix based on its ability to identify the links in the test set - to do this plot the familiar AUC vs phenes plot.

\subsection{Evaluation method C}
Here, as in \ref{sec:Evaluation method B}, set aside a set of gene-phene links as a test set, and use the remainder to score potential gene-phene links. But, we measure the goodness of a predictor based on how good its top 25 predictions are. To do this, we create the Receiver Operating Characteristic (ROC) plot, which measures the tradeoff between sensitivity and specifity while making 5, 10, 15, 20, 25 predictions, for the average phene.

Biologists will probably care only about the top few predictions produced by an algorithm, while ignoring the ranking of the 16000+ genes which may also be produced by the predictor. From this perspective, among the three evaluation methods we have considered, Evaluation method C appears to be the best evaluation strategy.

\section{Predictors compared}
In this report, besides the phenologs-predictor from \cite{McGaryOrthologousPhenotypes}, we consider predictors which score gene-phene links based on graph proximity and on latent factors. It should be noted that, unlike most (but not all) of these predictors, implementations of the phenologs predictor which we compare against make use of only the gene-phene matrices from four species.

\subsection{Notation}
\label{sec:Notation}
In the rest of this section, we denote the gene-phene interaction matrix for a given species with acronym $s$ by $P_s$. Refer Table \ref{tab:acronyms} for species acronyms. We denote the human gene interaction matrix by $G$. Also, let $P = \mat{P_{At} & P_{Ce} & P_{Dm} & P_{Mm} & P_{Sc}}$.

\begin{table}[ht]
\centering
\begin{tabular}{| c | c |} \hline
\textsc{Species} & \textsc{Acronym} \\ \hline
Human & Hs \\ \hline
Plant & At \\ \hline
Worm & Ce \\ \hline
Fly  & Dm \\ \hline
Mouse & Mm \\ \hline
Yeast & Sc \\ \hline
\end{tabular}
\caption{Acronyms of species.}
\label{tab:acronyms}
\end{table}


\subsection{Graph proximity based predictors}
\label{sec:Graph proximity based predictors}
For a given adjacency matrix $A = A^{T}$, we define: $$tKatz(A, \gb, k) \dfn \sum_{i = 1}^{k} \gb^{i} A^{i}.$$

For the predictors described here, the score matrix used for prediction has the form $tKatz(A, \gb, k)P_{Hs}$, where $P_{Hs}$ is the human gene-phene adjacency matrix. For these predictors, while k = 4 is fixed, the parameter $\gb$ is determined by comparing the performance they yield in correctly identifying a randomly selected subset of the known gene-phene relationships, a process known as 'validation'. In Table \ref{tab:graphProximityPredictors}, we specify the choices for A we have tried.

\begin{table*}[h]
\centering
\begin{tabular}{| p{5 cm} |c |} \hline
Predictor Name& Choice of A \\ \hline \hline
katzOtherSpecies& $PP^T$\\ \hline
katzHumanGeneInteractions& G \\ \hline
\end{tabular}
\caption{Some graph proximity predictors. Refer Section \ref{sec:Notation} for notation.}
\label{tab:graphProximityPredictors}
\end{table*}

\subsection{Latent factors based predictors}
Predictors of this class model the genes and phenes as having low-dimensional representations. For the predictors we are concerned with here, we derive a matrix for scoring the possible connections between human genes and phenes by using the singular value decomposition (SVD) to get a rank-k approximation of a matrix $A(\gl)$ described later. Such predictions are parametrized by $\gl$ and k. These parameters are determined using the validation process earlier described briefly in Section \ref{sec:Graph proximity based predictors}.

In case of the predictor labelled \textit{svdApproxOtherSpecies}, we let $A(\gl) = \mat{\gl PP^T & P_{Hs}\\P_{Hs}^T & 0}$.

In case of the predictor labelled \textit{svdCombined}, we let $A(\gl) = \mat{\gl G & \gl P & P_{Hs}\\\gl P^T & 0& 0\\ P_{Hs}^T & 0& 0}$, 
where $P$ is described in Section \ref{sec:Notation}. Note that this predictor, unlike all other predictors considered here, combines information from all available sources of information.

\subsection{Reproducing the phenolog predictor}
\label{sec:Reproducing the phenolog predictor}
The method developed in \cite{McGaryOrthologousPhenotypes, McGarySI} uses a naive Bayes classifier to determine the probability of a gene influencing a given disease, given the evidence of expression of the gene in orthologous phenotypes of other organisms. The ``closest'' phenotypes are determined using a distance function based on the hypergeometric probability of observing the overlap of genes between two given phenotypes by chance.

To make sure that our way of comparing the performances of predictors is fair, we reproduced the predictor in \cite{McGaryOrthologousPhenotypes}. We compared the results from our implementation with the ones obtained from Marcotte lab. See Figures \ref{fig:probabilisticFixedVsProbabilistic_QualitativeTest} and \ref{fig:Phene2ScoreDistMarcotte}. These figures indicate that, while there is a slight difference in the scores obtained in our reproduction of the phenolog predictor, for the purposes of evaluation and comparison, they are equivalent. 

In this document, we call the predictor in \cite{McGaryOrthologousPhenotypes} as the \emph{phenologs predictor}.

\begin{figure}[h]
\includegraphics[scale=0.5]{../log/comparisons/probabilisticFixedVsProbabilistic_QualitativeTest2010-06-21-13:25:15:535.jpg}
\caption{Comparison, using evaluation method A, of our reproduction of the phenologs predictor vs similar scores obtained from the Marcotte lab. See Section \ref{sec:Reproducing the phenolog predictor}.}
\label{fig:probabilisticFixedVsProbabilistic_QualitativeTest}
\end{figure}

\begin{figure}[h]
\includegraphics[scale=0.3]{../log/Phene2ScoreDistMarcotte.jpg}
\includegraphics[scale=0.3]{../log/Phene2ScoreDistOurs.jpg}
\caption{Scores obtained for phene 2 by our reproduction of the phenologs predictor vs scores obtained from Marcotte lab. Observe that the reproduced scores are very similar to those obtained from Marcotte lab. See Section \ref{sec:Reproducing the phenolog predictor}.}
\label{fig:Phene2ScoreDistMarcotte}
\end{figure}

\section{Evaluation of latent factors predictors}
\label{sec:Evaluation of latent factors predictors}
Even though the latent factors based predictors are superior to the phenolog predictor according to evaluation methods A and B, as seen from Figures \ref{fig:probabilisticFixedVsSVDOtherSpecies_QualitativeTest2010} and \ref{fig:probabilisticVsLatentFactors2010}, according to evaluation method C, as seen in Figure \ref{fig:probabilisticVsLatentFactorsROC2010}, the reverse is true.

Comparing the latent factors predictors using evaluation methods B and C, as seen in Figures \ref{fig:probabilisticVsLatentFactors2010} and \ref{fig:probabilisticVsLatentFactorsROC2010}, we see significant benefit is derived by using information from both the human gene-gene interactions network and the gene-phene networks corresponding to other species, rather than just the latter.

\begin{figure}[h]
\includegraphics[scale=0.5]{../log/comparisons/probabilisticFixedVsSVDOtherSpecies_QualitativeTest2010-06-21-13:25:17:035.jpg}
\caption{Comparison, using evaluation method A, of latent factors predictors with the phenologs predictor. See Section \ref{sec:Evaluation of latent factors predictors}. (Note that the combined SVD predictor is not included -- we did not use evaluation method A, most time consuming among the three, to demonstrate the benefits of combining different sources.)}
\label{fig:probabilisticFixedVsSVDOtherSpecies_QualitativeTest2010}
\end{figure}

\begin{figure}[h]
\includegraphics[scale=0.5]{../log/comparisons/probabilisticVsLatentFactors2010-06-21-13:25:18:606.jpg}
\caption{Comparison, using evaluation method B, of latent factors predictors with the phenologs predictor. See Section \ref{sec:Evaluation of latent factors predictors}.}
\label{fig:probabilisticVsLatentFactors2010}
\end{figure}

\begin{figure}[h]
\includegraphics[scale=0.5]{../log/comparisons/probabilisticVsLatentFactorsROC2010-06-21-13:25:23:538.jpg}
\caption{Comparison, using evaluation method C, of latent factors predictors with the phenologs predictor. See Section \ref{sec:Evaluation of latent factors predictors}.}
\label{fig:probabilisticVsLatentFactorsROC2010}
\end{figure}


\section{Evaluation of graph proximity based predictors}
\label{sec:Evaluation of graph proximity based predictors}
As seen from Figures \ref{fig:probabilisticVsGraphProximity2010} and \ref{fig:probabilisticVsGraphProximityROC2010}, the graph proximity predictors we have so far tested proved to be superior to the phenolog based predictor, though they don't use information from both the human gene-gene interactions network and gene-phene networks from other species simultaneously as yet. Note that the superiority of graph proximity based predictors over the latent factors based predictors, as observed from Figures \ref{fig:probabilisticVsGraphProximityROC2010} and \ref{fig:probabilisticVsLatentFactorsROC2010}, is consistent with observations made in \cite{vasukiNatarajan}.

\begin{figure}[h]
\includegraphics[scale=0.5]{../log/comparisons/probabilisticVsGraphProximity2010-06-21-13:25:20:893.jpg}
\caption{Comparison, using evaluation method B, of graph proximity based predictors with the phenologs predictor. See Section \ref{sec:Evaluation of graph proximity based predictors}.}
\label{fig:probabilisticVsGraphProximity2010}
\end{figure}

\begin{figure}[h]
\includegraphics[scale=0.5]{../log/comparisons/probabilisticVsGraphProximityROC2010-06-21-13:25:25:237.jpg}
\caption{Comparison, using evaluation method C, of graph proximity based predictors with the phenologs predictor. See Section \ref{sec:Evaluation of graph proximity based predictors}.}
\label{fig:probabilisticVsGraphProximityROC2010}
\end{figure}

\section{Conclusion}
In Section \ref{sec:Three Evaluation methods}, we compared three evaluation strategies, and argued that Evaluation strategy C seems to be the best for the purpose of comparing predictor performance. We have evaluated the performance of various predictors using these three evaluation strategies. We see that graph proximity based predictors consistently outperform all other predictors. We also realize the potential of combining multiple sources of information, though the experiments are simple and preliminary, as observed from Figure \ref{fig:probabilisticVsLatentFactorsROC2010}. We are yet to see how graph proximity methods can be used to effectively combine all the available sources of information.

\bibliographystyle{plain}
\bibliography{../grantProposal/references}

\end{document}
